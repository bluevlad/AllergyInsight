# AllergyInsight 프로젝트 기획서

**문서 버전:** v1.0
**작성일:** 2026.01.13
**작성자:** 개발팀
**검토자:** 담당자, 엔지니어

---

## 1. 프로젝트 개요

### 1.1 프로젝트명
**AllergyInsight** - 알러지 검사 결과 기반 지능형 정보 제공 시스템

### 1.2 프로젝트 배경
- 알러지 검사 결과 해석에 전문 지식이 필요함
- 관련 논문 및 연구 자료가 방대하여 수작업 검색에 한계가 있음
- 알러지 항목 간 **교차 반응(Cross-Reactivity)** 정보 파악이 중요함
- 의료진 및 연구자에게 신뢰할 수 있는 레퍼런스 기반 정보 제공 필요

### 1.3 프로젝트 목적
| 목적 | 설명 |
|------|------|
| **정보 접근성 향상** | 알러지 관련 논문 정보를 쉽고 빠르게 검색 |
| **교차 반응 정보 제공** | 양성 알러지 항목 간 교차 가능성 자동 분석 |
| **업무 효율화** | 수작업 문서 작성을 자동화하여 시간 절약 |
| **근거 기반 정보** | 논문 레퍼런스를 포함한 신뢰성 있는 정보 제공 |

### 1.4 기대 효과
- 알러지 검사 결과 분석 시간 **80% 이상 단축**
- 교차 반응 정보 누락 방지
- 일관된 품질의 분석 리포트 생성
- 수백~수천 개의 논문 레퍼런스 활용 가능

---

## 2. 요구사항 정의

### 2.1 기능 요구사항 (Functional Requirements)

| ID | 기능명 | 설명 | 우선순위 |
|----|--------|------|----------|
| FR-01 | 논문 DB 구축 | PDF 논문 파일을 업로드하면 자동으로 텍스트 추출 및 Vector DB 저장 | **필수** |
| FR-02 | 문장 분할(Chunking) | 논문을 문단/문장 단위로 분할하여 검색 효율성 확보 | **필수** |
| FR-03 | RAG 검색 | 알러지 항목명으로 관련 논문 문장 유사도 검색 | **필수** |
| FR-04 | 교차 반응 조회 | 양성 알러지 항목들의 교차 반응 가능성 정보 제공 | **필수** |
| FR-05 | 프롬프트 자동 생성 | 검색 결과를 LLM에 전달할 프롬프트로 자동 구성 | **필수** |
| FR-06 | LLM 연동 | AI 모델을 통한 자연어 응답 생성 | **필수** |
| FR-07 | 자동 문서 생성 | 분석 결과를 Word/PDF 리포트로 자동 생성 | 선택 |
| FR-08 | 레퍼런스 관리 | 논문 출처 정보 관리 및 표시 | 선택 |

### 2.2 비기능 요구사항 (Non-Functional Requirements)

| ID | 항목 | 요구사항 |
|----|------|----------|
| NFR-01 | 응답 시간 | 검색 결과 3초 이내 반환 |
| NFR-02 | 동시 사용자 | 최소 10명 동시 접속 지원 |
| NFR-03 | 데이터 보안 | 논문 데이터 및 검색 기록 암호화 저장 |
| NFR-04 | 확장성 | 논문 추가 시 DB 재구축 없이 증분 업데이트 |
| NFR-05 | 가용성 | 99% 이상 서비스 가용성 |

### 2.3 사용자 시나리오

```
[시나리오 1: 알러지 검사 결과 분석]

1. 사용자가 알러지 검사 결과를 입력 (예: 땅콩 3등급, 우유 2등급, 계란 1등급)
2. 시스템이 각 알러지 항목에 대해 RAG 검색 수행
3. 관련 논문 정보와 교차 반응 가능성 조회
4. LLM이 검색 결과를 자연어로 요약
5. 사용자에게 레퍼런스 포함된 분석 결과 제공
6. (선택) 리포트 문서로 다운로드
```

```
[시나리오 2: 논문 DB 구축]

1. 관리자가 PDF 논문 파일들을 업로드
2. 시스템이 PDF에서 텍스트 추출 (또는 엑셀 변환 후 업로드)
3. 텍스트를 문장/문단 단위로 분할
4. 각 청크에 대해 임베딩 벡터 생성
5. Vector DB에 저장 완료
6. 검색 가능 상태로 전환
```

---

## 3. 시스템 아키텍처

### 3.1 전체 구성도

```
┌─────────────────────────────────────────────────────────────────────────┐
│                        AllergyInsight System                            │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   [데이터 수집 레이어]                                                    │
│   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                │
│   │ PDF Upload  │───▶│ PDF Parser  │───▶│ Excel Conv. │                │
│   │   Module    │    │ (텍스트추출) │    │  (선택사항)  │                │
│   └─────────────┘    └─────────────┘    └──────┬──────┘                │
│                                                 │                       │
│   [데이터 처리 레이어]                           ▼                       │
│   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                │
│   │   Chunker   │◀───│ Text Clean  │◀───│ Raw Text    │                │
│   │ (문장분할)   │    │  (전처리)    │    │   Input     │                │
│   └──────┬──────┘    └─────────────┘    └─────────────┘                │
│          │                                                              │
│          ▼                                                              │
│   ┌─────────────┐    ┌─────────────┐                                   │
│   │  Embedding  │───▶│ Vector DB   │◀─────────────────┐                │
│   │  Generator  │    │ (ChromaDB)  │                  │                │
│   └─────────────┘    └─────────────┘                  │                │
│                                                       │                │
│   [서비스 레이어]                                      │                │
│   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                │
│   │  Frontend   │◀──▶│  Backend    │───▶│ RAG Engine  │                │
│   │   (React)   │    │  (FastAPI)  │    │  (검색엔진)  │                │
│   │  Port:4040  │    │  Port:9040  │    └─────────────┘                │
│   └─────────────┘    └──────┬──────┘                                   │
│                             │                                          │
│   [AI 레이어]               ▼                                          │
│   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                │
│   │   Prompt    │───▶│  LLM API    │───▶│  Response   │                │
│   │  Builder    │    │(GPT/Claude) │    │  Parser     │                │
│   └─────────────┘    └─────────────┘    └─────────────┘                │
│                                                │                       │
│   [출력 레이어]                                 ▼                       │
│   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐                │
│   │   Report    │◀───│  Template   │◀───│   Result    │                │
│   │  Generator  │    │   Engine    │    │  Formatter  │                │
│   └─────────────┘    └─────────────┘    └─────────────┘                │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 3.2 데이터 흐름도

```
[논문 등록 플로우]
PDF 파일 ──▶ 텍스트 추출 ──▶ 전처리 ──▶ 청킹 ──▶ 임베딩 ──▶ Vector DB

[검색 플로우]
알러지 항목 ──▶ 쿼리 임베딩 ──▶ 유사도 검색 ──▶ Top-K 결과 ──▶ 프롬프트 생성 ──▶ LLM ──▶ 응답
```

### 3.3 데이터베이스 설계

#### Vector DB (논문 데이터)
| 필드 | 타입 | 설명 |
|------|------|------|
| id | UUID | 고유 식별자 |
| content | TEXT | 분할된 문장/문단 텍스트 |
| embedding | VECTOR | 임베딩 벡터 (1536차원) |
| paper_id | STRING | 원본 논문 ID |
| paper_title | STRING | 논문 제목 |
| page_num | INT | 페이지 번호 |
| created_at | DATETIME | 등록일시 |

#### 관계형 DB (메타데이터)
| 테이블 | 설명 |
|--------|------|
| papers | 논문 메타정보 (제목, 저자, 발행년도, DOI) |
| allergens | 알러지 항목 마스터 (120종) |
| cross_reactions | 교차 반응 매핑 테이블 |
| search_logs | 검색 이력 |

---

## 4. 기술 스택 비교 및 제안

### 4.1 Vector DB 솔루션 비교

| 솔루션 | 장점 | 단점 | 비용 | 추천도 |
|--------|------|------|------|--------|
| **ChromaDB** | 설치 간편, Python 네이티브, 오픈소스 | 대규모 데이터 시 성능 저하 가능 | 무료 | ★★★★★ |
| **Pinecone** | 관리형 서비스, 높은 성능, 확장성 | 유료, 외부 의존성 | 월 $70~ | ★★★★☆ |
| **Weaviate** | GraphQL 지원, 하이브리드 검색 | 학습 곡선 있음 | 무료/유료 | ★★★☆☆ |
| **Milvus** | 대규모 데이터 처리, 고성능 | 설정 복잡, 리소스 많이 사용 | 무료 | ★★★☆☆ |
| **Qdrant** | Rust 기반 고성능, REST/gRPC | 비교적 신생 | 무료 | ★★★★☆ |

**권장:** 초기에는 **ChromaDB**로 시작, 데이터 증가 시 **Pinecone** 또는 **Qdrant**로 마이그레이션

### 4.2 임베딩 모델 비교

| 모델 | 특징 | 한국어 지원 | 비용 | 추천도 |
|------|------|-------------|------|--------|
| **OpenAI text-embedding-3-small** | 고품질, 1536차원 | 양호 | $0.02/1M tokens | ★★★★★ |
| **OpenAI text-embedding-3-large** | 최고 품질, 3072차원 | 양호 | $0.13/1M tokens | ★★★★☆ |
| **KoSimCSE** | 한국어 특화, 오픈소스 | 최상 | 무료 | ★★★★☆ |
| **multilingual-e5-large** | 다국어 지원, 오픈소스 | 양호 | 무료 | ★★★★☆ |
| **BGE-M3** | 다국어, 고성능, 오픈소스 | 양호 | 무료 | ★★★★★ |

**권장:** 논문이 영문 위주면 **OpenAI**, 한국어 포함 시 **BGE-M3** 또는 **KoSimCSE**

### 4.3 LLM 솔루션 비교

| 모델 | 장점 | 단점 | 비용 | 추천도 |
|------|------|------|------|--------|
| **GPT-4o** | 높은 성능, 빠른 응답 | 비용 | $2.5/1M input | ★★★★★ |
| **GPT-4o-mini** | 가성비, 충분한 성능 | GPT-4 대비 성능 낮음 | $0.15/1M input | ★★★★★ |
| **Claude 3.5 Sonnet** | 긴 컨텍스트, 정확성 | API 제한 | $3/1M input | ★★★★☆ |
| **Claude 3.5 Haiku** | 빠른 속도, 저렴 | 복잡한 추론 약함 | $0.25/1M input | ★★★★☆ |
| **Gemini 1.5 Pro** | 긴 컨텍스트(1M) | 한국어 품질 변동 | $1.25/1M input | ★★★☆☆ |

**권장:** 일반 검색은 **GPT-4o-mini**, 복잡한 분석은 **GPT-4o** 또는 **Claude 3.5 Sonnet**

### 4.4 PDF 파싱 솔루션 비교

| 솔루션 | 장점 | 단점 | 비용 | 추천도 |
|--------|------|------|------|--------|
| **PyMuPDF (fitz)** | 빠른 속도, 테이블 추출 | 복잡한 레이아웃 어려움 | 무료 | ★★★★☆ |
| **pdfplumber** | 테이블 추출 우수 | 속도 느림 | 무료 | ★★★★☆ |
| **Unstructured.io** | AI 기반, 높은 정확도 | 설정 복잡, 리소스 많이 사용 | 무료/유료 | ★★★★★ |
| **LlamaParse** | LLM 기반 파싱, 고품질 | 유료, API 의존 | 유료 | ★★★★☆ |
| **Adobe PDF Extract API** | 최고 품질 | 고비용 | 유료 | ★★★☆☆ |

**권장:** 일반 논문은 **PyMuPDF + pdfplumber**, 복잡한 논문은 **Unstructured.io**

### 4.5 RAG 프레임워크 비교

| 프레임워크 | 장점 | 단점 | 추천도 |
|------------|------|------|--------|
| **LangChain** | 풍부한 기능, 대규모 커뮤니티 | 복잡함, 오버헤드 | ★★★★☆ |
| **LlamaIndex** | RAG 특화, 다양한 인덱스 | 학습 곡선 | ★★★★★ |
| **Haystack** | 프로덕션 레디, 파이프라인 | 무거움 | ★★★☆☆ |
| **직접 구현** | 가볍고 커스터마이징 용이 | 개발 시간 필요 | ★★★★☆ |

**권장:** **LlamaIndex** (RAG 특화) 또는 간단한 경우 **직접 구현**

---

## 5. 구현 범위 정의

### 5.1 Phase 1: MVP (최소 기능 제품)

| 기능 | 상세 |
|------|------|
| PDF 업로드 | 단일/다중 PDF 파일 업로드 |
| 텍스트 추출 | PDF → 텍스트 변환 |
| Vector DB 저장 | ChromaDB에 임베딩 저장 |
| 기본 검색 | 알러지 항목명으로 검색 |
| 결과 표시 | 관련 논문 문장 목록 표시 |

### 5.2 Phase 2: 핵심 기능

| 기능 | 상세 |
|------|------|
| 교차 반응 DB | 교차 반응 매핑 테이블 구축 |
| LLM 연동 | GPT/Claude API 연동 |
| 프롬프트 생성 | 검색 결과 기반 자동 프롬프트 |
| 다중 알러지 처리 | 1~120개 알러지 항목 동시 처리 |

### 5.3 Phase 3: 고도화

| 기능 | 상세 |
|------|------|
| 자동 문서 생성 | Word/PDF 리포트 생성 |
| 레퍼런스 관리 | 논문 출처 자동 첨부 |
| 검색 이력 | 사용자별 검색 기록 저장 |
| 관리자 기능 | 논문 관리, 통계 대시보드 |

---

## 6. 리스크 및 고려사항

### 6.1 기술적 리스크

| 리스크 | 영향도 | 발생확률 | 대응방안 |
|--------|--------|----------|----------|
| PDF 파싱 품질 저하 | 높음 | 중간 | 엑셀 변환 옵션 제공, 수동 보정 기능 |
| 임베딩 품질 문제 | 높음 | 낮음 | 다양한 임베딩 모델 테스트 후 선정 |
| LLM 환각(Hallucination) | 중간 | 중간 | RAG로 근거 제한, 레퍼런스 필수 표시 |
| Vector DB 성능 저하 | 중간 | 낮음 | 인덱스 최적화, 필요시 솔루션 교체 |

### 6.2 비즈니스 리스크

| 리스크 | 영향도 | 발생확률 | 대응방안 |
|--------|--------|----------|----------|
| 후원 방식 미정 | 중간 | 높음 | 조기에 후원/비용 모델 결정 필요 |
| 요구사항 변경 | 중간 | 중간 | 애자일 방식 개발, MVP 우선 |
| 논문 저작권 이슈 | 높음 | 낮음 | 내부 사용 한정, 라이선스 확인 |

### 6.3 미결정 사항 (확인 필요)

| 항목 | 현재 상태 | 결정 필요 시점 |
|------|----------|----------------|
| 후원 방식 | 미정 | Phase 1 시작 전 |
| 사용자 질문 방식 | 미정 (검사 결과 입력 형태) | Phase 1 |
| 알러지 등급(Class) 처리 | 일단 제외하기로 함 | Phase 2 |
| 레퍼런스 표시 방식 | 미정 (포함/미포함) | Phase 2 |

---

## 7. 용어 정의

| 용어 | 설명 |
|------|------|
| **RAG** | Retrieval-Augmented Generation. 검색 결과를 LLM에 제공하여 응답 생성 |
| **Vector DB** | 텍스트를 벡터(숫자 배열)로 변환하여 유사도 검색이 가능한 데이터베이스 |
| **Embedding** | 텍스트를 고차원 벡터로 변환하는 과정 |
| **Chunking** | 긴 문서를 검색 가능한 작은 단위로 분할하는 과정 |
| **교차 반응** | 한 알러지 항원에 양성인 경우 다른 항원에도 반응할 가능성 |
| **LLM** | Large Language Model. GPT, Claude 등 대규모 언어 모델 |

---

## 8. 승인 및 피드백

### 8.1 검토 항목

- [ ] 프로젝트 목적 및 배경이 정확한가?
- [ ] 기능 요구사항이 충분히 정의되었는가?
- [ ] 우선순위가 적절한가?
- [ ] 기술 스택 선정이 적합한가?
- [ ] 누락된 요구사항이 있는가?
- [ ] 리스크 대응방안이 적절한가?

### 8.2 피드백 기록

| 날짜 | 검토자 | 피드백 내용 | 반영 여부 |
|------|--------|-------------|-----------|
| | | | |
| | | | |
| | | | |

### 8.3 승인

| 역할 | 이름 | 서명 | 날짜 |
|------|------|------|------|
| 담당자 | | | |
| 엔지니어 | | | |
| 개발팀 | | | |

---

## 부록 A: 참고 자료

### 오픈소스 RAG 구현 예시
- LlamaIndex 공식 문서: https://docs.llamaindex.ai/
- LangChain RAG 튜토리얼: https://python.langchain.com/docs/tutorials/rag/
- ChromaDB 가이드: https://docs.trychroma.com/

### 유사 솔루션 참고
- PubMed GPT: 의학 논문 검색 AI
- Consensus: 학술 논문 AI 검색 엔진
- Elicit: 연구 논문 분석 도구

---

*본 문서는 프로젝트 진행에 따라 업데이트될 수 있습니다.*
